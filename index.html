<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Upload Documents | MAXIMAX Multi Services</title>
  <style>
    :root{--accent:#f6a85f;--border:rgba(246,168,95,.45);--muted:rgba(246,168,95,.78)}
    body{margin:0;font-family:Arial;background:#070707;color:var(--accent)}
    .wrap{max-width:900px;margin:0 auto;padding:16px}
    .card{border:1px solid var(--border);border-radius:16px;padding:16px;background:rgba(255,255,255,.03)}
    label{display:block;margin:10px 0 6px;color:var(--muted);font-weight:800}
    input,select,button{width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:#0b0b0b;color:var(--accent);font-weight:800}
    button{cursor:pointer;background:linear-gradient(90deg,rgba(246,168,95,.95),rgba(255,138,42,.95));color:#1a0e05;border:none;margin-top:12px}
    .msg{margin-top:12px;padding:12px;border-radius:12px;border:1px dashed var(--border);color:var(--muted);font-weight:800;white-space:pre-wrap}
    .top{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}
    .top a{color:var(--accent);text-decoration:none;border:1px solid var(--border);padding:10px 12px;border-radius:999px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <a href="index.html">HOME</a>
      <a href="contact.html">CONTACT</a>
      <a href="translation.html">TRANSLATION</a>
    </div>

    <div class="card">
      <h2 style="margin:0 0 6px 0;">Secure Upload</h2>
      <div style="color:var(--muted);font-weight:800;line-height:1.6;">
        Upload your document (PDF/JPG/PNG). We will contact you with next steps.
      </div>

      <label>Your Name</label>
      <input id="name" type="text" placeholder="Full name" required>

      <label>Phone Number</label>
      <input id="phone" type="tel" placeholder="(xxx) xxx-xxxx" required>

      <label>Service</label>
      <select id="service">
        <option>Translation</option>
        <option>Immigration</option>
        <option>Tax</option>
        <option>Government Forms</option>
        <option>Other</option>
      </select>

      <label>Select File (PDF/JPG/PNG)</label>
      <input id="file" type="file" accept=".pdf,.jpg,.jpeg,.png" required>

      <button id="btn">UPLOAD NOW</button>
      <div id="msg" class="msg">Status: ready</div>
    </div>
  </div>

  <!-- Firebase (CDN) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";
    import { getStorage, ref, uploadBytes } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-storage.js";

    // ✅ PASTE YOUR firebaseConfig HERE (from Firebase console)
    const firebaseConfig = {
      apiKey: "PASTE",
      authDomain: "PASTE",
      projectId: "PASTE",
      storageBucket: "PASTE",
      messagingSenderId: "PASTE",
      appId: "PASTE"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    const $ = (id) => document.getElementById(id);
    const msg = (t) => $("msg").textContent = t;

    $("btn").addEventListener("click", async () => {
      try{
        const name = $("name").value.trim();
        const phone = $("phone").value.trim();
        const service = $("service").value;
        const file = $("file").files[0];

        if(!name || !phone || !file){
          msg("Status: please fill name + phone + choose a file.");
          return;
        }

        // Basic file validation
        const okTypes = ["application/pdf","image/jpeg","image/png"];
        if(!okTypes.includes(file.type)){
          msg("Status: file must be PDF, JPG, or PNG.");
          return;
        }
        if(file.size > 25 * 1024 * 1024){
          msg("Status: file too large (max 25MB).");
          return;
        }

        msg("Uploading… please wait.");

        // Create a unique path
        const safeName = name.replace(/\s+/g,'_').replace(/[^\w\-]/g,'');
        const stamp = Date.now();
        const path = `uploads/${service}/${safeName}_${stamp}_${file.name}`;

        // Upload to Storage
        const storageRef = ref(storage, path);
        await uploadBytes(storageRef, file);

        // Save metadata in Firestore (no public download URL yet)
        const docRef = await addDoc(collection(db,"uploads"),{
          name, phone, service,
          fileName: file.name,
          fileType: file.type,
          fileSize: file.size,
          storagePath: path,
          createdAt: serverTimestamp(),
          status: "received"
        });

        msg(`✅ Uploaded successfully!
Reference: ${docRef.id}
We received your document. We will contact you soon.`);

        // Reset
        $("file").value = "";
      }catch(e){
        console.error(e);
        msg("❌ Upload failed:\n" + (e?.message || e));
      }
    });
  </script>
</body>
</html>
